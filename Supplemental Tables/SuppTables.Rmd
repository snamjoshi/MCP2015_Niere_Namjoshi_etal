---
title: "Supplemental Tables for Niere and Namjoshi et al. 2015, MCP"
author: "Sanjeev V Namjoshi"
date: "Revised for GitHub: October 29, 2015"
output: 
  html_document: 
    highlight: haddock
    keep_md: yes
---

**Code was written between April 2014 through February 2015**

This file includes all of the code and data files needed to replicate some of the results obtained from the supplemental tables.

## Table S2

First, let's create the `read.csv.list` function which reads a CSV file with uneven columns and converts it to a list instead of a dataframe. This is pretty common when uploading gene lists and this is an easy fix for it.

```{r}
# Function reads a CSV file with uneven columns and coverts to a list instead of a dataframe

read.csv.list <- function(file, header) {
	outputList <- apply(read.csv(file, header = header), 2, list)
	outputList <- lapply(outputList, function(x) lapply(x, '[', which(complete.cases(x))))
	
	return(outputList)
}
```

Load the data. This data is a network stats file that has all of the network stats calculated by Cytoscape for the DMSO network, the rapa network, and a randomly generated network.

```{r}
network <- read.csv.list("networkStats.csv", TRUE)
```

First we need to summarize the data by mean and standard deviation as it is included in the table.

```{r}
meanLysate <- unlist(lapply(network, function(x) mean(as.numeric(unlist(x)))))
sdLysate <- unlist(lapply(network, function(x) sd(as.numeric(unlist(x)))))

summaryLysate <- data.frame(mean = round(meanLysate, 3), sd = round(sdLysate, 2))

summaryLysate
```

Next we perform all of the tests whose P-values are listed in the table. The DMSO network, rapa network, and random networks were generated in Cytoscape first and all of the network statistics data was exported.

```{r, warning = FALSE}
# DMSO Lysate Analysis
dmsoAnalysis <- lapply(network[c(1,4,7)], function(x) wilcox.test(as.numeric(unlist(x)), alternative = "greater"))

# Rapa Lysate Analysis
rapaAnalysis <- lapply(network[c(2,5,8)], function(x) wilcox.test(as.numeric(unlist(x)), alternative = "greater"))

# Random Clustering Coefficent DMSO
randDmsoCC <- ks.test(as.numeric(unlist(network[[4]])), as.numeric(unlist(network[[6]])), alternative = "two.sided")

# Random Clustering Coefficent Rapa
randRapaCC <- ks.test(as.numeric(unlist(network[[5]])), as.numeric(unlist(network[[6]])), alternative = "two.sided")

# Random Neighborhood Connectivity DMSO
randDmsoNC <- ks.test(as.numeric(unlist(network[[7]])), as.numeric(unlist(network[[9]])), alternative = "two.sided")

# Random Neighborhood Connectivity Rapa
randRapaNC <- ks.test(as.numeric(unlist(network[[8]])), as.numeric(unlist(network[[9]])), alternative = "two.sided")
```

Next, we put it all into a table.

```{r}
summary <- data.frame(P.value = c(unname(unlist(sapply(dmsoAnalysis, "[", 3))), unname(unlist(sapply(rapaAnalysis, "[", 3))), randDmsoCC$p.value, randRapaCC$p.value, randDmsoNC$p.value, randRapaNC$p.value),
					 						row.names = c("DMSO Closeness Centrality", "DMSO Clustering Coefficient", "DMSO Neighborhood Connectivity", "Rapa Closeness Centrality", "Rapa Clustering Coefficient", "Rapa Neighborhood Connectivity", "Random DMSO Clustering Coefficent", "Random Rapa Clustering Coefficient", "Random DMSO Neighborhood Connectivity", "Random Rapa Neighborhood Connectivity"))

summary <- cbind(summary, LessThan0.001 = summary$P.value < 0.001)

summary
```

The number of proteins, can be found in the Data Processing file. Characteristic path length, network density, nodes, and edges calculated from Cytoscape built-in statistics.

## Table S4

This data file is the same one that is generated by the data processing file. It is included in the same GitHub repo as this markdown file.

```{r}
fullList <- read.csv("fullList.csv", header = TRUE, stringsAsFactors = FALSE)
```

First get data into correct form. The `oorToNa()` function changes out-of-range genes to NAs that way numeric calculations can be performed.

```{r}
oorToNa <- function(geneList) {
	geneList[geneList == "LOW"] <- NA
	geneList[geneList == "HIGH"] <- NA
	geneList[geneList == "<NA>"] <- NA
	
	return(geneList)
}

fullListNumeric <- oorToNa(fullList)
```

Now we can output the PSD proteins seen in table S4. The comment here indicates there are 76 proteins as reported in the paper.

```{r}
subset(fullListNumeric, as.numeric(PSD) > -0.1 & as.numeric(PSD) < 0.1, c("Gene", "PSD"))   # 76 proteins
```

## Table S5

Output of the PSD proteins seen in table S5. The comments here incidate that there were either 159 or 166 proteins in each of the two directions for the PSD.

```{r}
subset(fullListNumeric, as.numeric(PSD) < -0.1, c("Gene", "PSD"))  # 159 proteins
subset(fullListNumeric, as.numeric(PSD) > 0.1, c("Gene", "PSD"))   # 166 proteins
```

## Table S6

Output of the out-of-range proteins in the PSD. Note that we went back and manually removed proteins where the fold-change calculation may have been unreliable - in cases where there was either high variability between samples or where both genes only had data for 1 out of 3 specrtral counts for the replicates in the numerator or denominator.

```{r}
as.vector(na.omit(fullList[fullList$PSD == "HIGH", "Gene"]))
as.vector(na.omit(fullList[fullList$PSD == "LOW", "Gene"]))
```

## Table S7

See the figure 6 markdown file to generate these lists.

## Table S8

See tge figure 6 markdown file to generate these lists.

All other figures generated through either Cytoscape or DAVID or the output of the mass spectrometry data analysis.
